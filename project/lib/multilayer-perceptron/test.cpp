//
// Created by botan on 5/30/2020.
//


#include "network/MultiLayerNetwork.h"
#include "activation/implementation/Hyperbolic.h"
#include "activation/implementation/Softmax.h"
#include "activation/implementation/Relu.h"
#include <chrono>

using namespace std;

int main(int size, char **args) {
    //XOR & NXOR BRIDGE
    double
            test1[] = {0.32051294, -0.32890241,
                       0.73941345, -0.48117961,
                       -0.97121553, -0.07190905,
                       0.66280004, 0.51640211,
                       -0.20134853, 0.83205982,
                       -0.76341238, 0.85939843,
                       -0.68947326, 0.63357774,
                       -0.70687394, 0.76529166,
                       0.22923076, 0.27254441,
                       -0.76585897, 0.94795049,
                       -0.97139143, -0.57754072,
                       0.77460582, 0.78977665,
                       -0.84514433, 0.57371376,
                       0.61753737, -0.41903475,
                       -0.35735812, 0.94726437,
                       0.48097998, -0.67841332,
                       -0.94243566, -0.56392470,
                       -0.43458222, 0.60985490,
                       -0.80640205, -0.94747398,
                       -0.13457390, -0.15953495,
                       -0.97062243, 0.60509006,
                       0.06476667, 0.39666199,
                       0.69978116, 0.67838668,
                       -0.53474635, -0.50058617,
                       0.32383485, -0.36684971,
                       -0.75606473, 0.10318505,
                       -0.56669451, -0.96646443,
                       0.18703029, 0.74735074,
                       0.27963961, 0.97892592,
                       -0.26154015, -0.72410452,
                       -0.34905533, -0.59788165,
                       -0.54710305, 0.23035249,
                       -0.86142668, 0.79114570,
                       0.83000429, -0.63216365,
                       -0.45194145, 0.50668245,
                       0.69950362, 0.12621666,
                       -0.81583265, -0.14057753,
                       0.55208632, -0.46192057,
                       0.82278180, -0.99014488,
                       -0.24626343, 0.80123944,
                       -0.00816952, 0.49861082,
                       0.62627154, 0.55137073,
                       0.08228912, -0.06824893,
                       0.46284950, 0.94692805,
                       -0.06120319, 0.57375775,
                       0.80521419, 0.82126921,
                       0.47706395, 0.61677528,
                       -0.23801470, -0.72388103,
                       0.04715527, -0.61262054,
                       -0.05430903, 0.66987394,
                       -0.38482595, -0.10933626,
                       -0.04850731, -0.26375236,
                       0.40136989, 0.71857665,
                       0.07349784, 0.21931675,
                       0.53173395, -0.41137824,
                       -0.12332736, -0.51146434,
                       -0.14799090, 0.01917131,
                       0.78439091, -0.78059867,
                       -0.39650252, 0.03825987,
                       0.39201172, 0.91215956,
                       -0.10109883, 0.53049380,
                       0.10397102, -0.44698443,
                       -0.23773945, 0.91226023,
                       0.97354015, 0.42360098,
                       -0.50640371, -0.00067583,
                       -0.68642646, 0.74532898,
                       0.29174244, 0.85742465,
                       0.06089494, 0.10521912,
                       0.85183577, -0.38526144,
                       0.21977255, 0.93780396,
                       -0.23104405, 0.48448913,
                       -0.85722640, 0.21548834,
                       -0.16004057, 0.49611790,
                       0.98042999, 0.51106352,
                       0.71541319, 0.84661753,
                       0.31195289, 0.59241506,
                       -0.13944998, -0.83366943,
                       -0.24272783, -0.36320736,
                       -0.75594495, 0.66418641,
                       -0.50404488, 0.55426709,
                       0.23472923, -0.15546967,
                       -0.12700103, 0.70695022,
                       -0.95750747, -0.70987593,
                       -0.84421780, -0.15395827,
                       -0.66064912, -0.04362983,
                       -0.88028191, 0.86659223,
                       0.69575622, -0.32844652,
                       -0.00472508, 0.29662714,
                       0.97023054, 0.39104169,
                       -0.42119769, -0.36908306,
                       0.36237378, -0.48625985,
                       -0.70623537, -0.14171839,
                       0.39680821, -0.67039226,
                       0.68301116, 0.27372964,
                       -0.47195174, 0.77202271,
                       -0.48556785, -0.54638386,
                       -0.52780100, 0.59192314,
                       0.15414988, -0.95398537,
                       -0.33625672, -0.52787124,
                       -0.18177502, 0.45635229,
                       -0.17335921, 0.40863665,
                       -0.92215215, 0.68790888,
                       0.38138137, -0.92495018,
                       -0.34444497, -0.57032957,
                       -0.85961556, 0.49932974,
                       0.50808286, 0.30318602,
                       -0.28002952, 0.09199911,
                       0.08570122, 0.83503405,
                       0.23607056, -0.98344985,
                       0.17258026, 0.34817122,
                       -0.51223839, -0.18115128,
                       0.13885750, 0.75202866,
                       -0.73972431, -0.25081971,
                       0.85943148, -0.35352800,
                       -0.75651418, 0.10965676,
                       0.25160981, -0.29691450,
                       0.05513936, -0.70268419,
                       -0.44192893, 0.45542430,
                       -0.71756667, -0.02230718,
                       -0.01790944, 0.49572419,
                       -0.08069294, -0.37818900,
                       -0.85054889, -0.44456593,
                       -0.72288920, -0.21676482,
                       0.97130532, -0.38777383,
                       0.48861228, -0.15145217,
                       -0.84018525, -0.20484798,
                       -0.48654686, -0.87606422,
                       -0.73964771, -0.00318685,
                       0.55974637, 0.26244045,
                       -0.72955105, 0.36146480,
                       -0.84297838, 0.11020153,
                       -0.92656326, -0.66534284,
                       -0.60220290, -0.27641302,
                       0.50352916, -0.77496794,
                       0.35105466, -0.56078780,
                       -0.83197744, -0.88049465,
                       -0.02146596, 0.36569237,
                       -0.44799374, -0.61784035,
                       -0.88822316, 0.73230808,
                       -0.80107603, -0.43992751,
                       -0.61462190, -0.46232709,
                       -0.43677300, -0.45218084,
                       -0.85708822, 0.28613431,
                       0.84154543, 0.10613062,
                       0.42296122, 0.31737430,
                       -0.05721197, -0.61915751,
                       0.35679421, 0.95477904,
                       0.00716003, -0.25642154,
                       0.57480670, 0.04632691,
                       0.16381274, -0.02423153,
                       -0.28640353, -0.24506304,
                       -0.22563491, 0.06248376,
                       -0.02036093, 0.86335963,
                       0.42194034, -0.40881785,
                       -0.95375528, 0.08403022,
                       0.74018474, 0.32115450,
                       0.15622199, 0.43361150,
                       0.32431793, -0.83877094,
                       -0.04159655, 0.69393065,
                       0.12605316, 0.52058229,
                       0.45796506, -0.50796253,
                       0.21327938, -0.51140653,
                       -0.30400340, 0.67062874,
                       0.21511248, -0.62428510,
                       -0.91030632, 0.48598175,
                       -0.79664783, -0.17125514,
                       0.63445936, 0.16869642,
                       0.21197980, 0.96380144,
                       0.31974286, -0.56859469,
                       0.27532513, 0.66301474,
                       0.53189894, 0.27789560,
                       0.61059429, 0.42691922,
                       -0.45218045, 0.53254090,
                       0.51288952, -0.94470932,
                       -0.01630649, 0.40077850,
                       -0.84718043, -0.35405420,
                       0.77076241, -0.23167964,
                       -0.61130843, -0.86249916,
                       -0.70245959, -0.50006891,
                       -0.30400585, -0.09497453,
                       0.81005216, 0.14196344,
                       -0.57777424, -0.11807149,
                       0.73611531, -0.49477548,
                       0.01927989, 0.96854585,
                       -0.45876028, -0.37284699,
                       -0.55426742, -0.56392443,
                       -0.32106839, -0.99762435,
                       -0.75542244, 0.79351939,
                       0.27939380, 0.93130808,
                       -0.85828884, -0.99783846,
                       0.90885646, 0.16540567,
                       -0.91297155, 0.92082597,
                       0.86585779, 0.93455676,
                       -0.04672670, -0.33612443,
                       0.63345565, -0.35081590,
                       -0.13650767, 0.59321110,
                       0.19606375, 0.44544915,
                       -0.53686674, -0.88821040,
                       -0.44492579, 0.07799164,
                       0.74037861, -0.94696818,
                       -0.02714026, -0.53416204,
                       -0.43675276, -0.51958812,
                       -0.34984482, -0.39707472,
                       0.09092847, -0.72241903,
                       -0.55346275, 0.97579747,
                       0.19311683, 0.94526875,
                       -0.24698929, 0.00875900,
                       0.53265128, 0.65499998,
                       0.10309001, -0.27462385,
                       0.79812441, 0.09051717,
                       -0.08365691, -0.63151421,
                       0.21677860, -0.23017919,
                       -0.24488100, 0.64708819,
                       -0.47917451, 0.87629846,
                       -0.56024682, 0.78613577,
                       -0.24027597, 0.76426695,
                       0.36692212, 0.72484740,
                       -0.65539323, -0.56656995,
                       0.13211580, 0.28893569,
                       -0.73946388, -0.52594193,
                       0.85626533, 0.86520764,
                       0.43418945, 0.53180522,
                       -0.67483970, 0.51406614,
                       0.29718965, 0.29789743,
                       -0.73511427, 0.66140687,
                       -0.70838673, 0.83251049,
                       0.49136292, 0.18733620,
                       0.92833004, 0.97047525,
                       -0.70393915, 0.44285873,
                       0.14305303, 0.47152683,
                       -0.46877404, 0.81622582,
                       -0.68649931, 0.71072765,
                       -0.32839775, -0.67127856,
                       0.24024171, 0.67952605,
                       0.26809258, -0.84162676,
                       0.30482052, 0.28114427,
                       0.48200070, -0.52257437,
                       -0.20700795, -0.92903115,
                       -0.80029562, 0.64795581,
                       0.31747045, -0.90000196,
                       0.90602015, -0.40038636,
                       0.74792608, 0.32659326,
                       -0.85443511, -0.88103509,
                       -0.62557581, 0.77567570,
                       -0.94428077, 0.46815951,
                       0.21501196, -0.86394925,
                       -0.61271001, -0.56667009,
                       -0.05884217, -0.22093126,
                       0.74502525, -0.84861297,
                       0.51059116, 0.79449449,
                       -0.46150455, 0.51901585,
                       0.01007059, 0.77068279,
                       0.15015673, 0.53087138,
                       0.41323410, -0.75441201,
                       -0.47756578, -0.97023843,
                       -0.38832765, -0.14277521,
                       -0.69641994, 0.84170144,
                       0.25250865, -0.56424549,
                       0.26287177, 0.46792116,
                       -0.19331778, 0.57768800,
                       0.42418928, -0.61460064,
                       0.13483632, -0.10540192,
                       0.18982450, 0.72770776,
                       0.85907420, -0.92165572,
                       -0.50902904, 0.29326196,
                       -0.95354963, -0.49567937,
                       0.42022105, -0.54002652,
                       -0.08070291, -0.73713391,
                       -0.36769093, 0.95803608,
                       0.67711781, 0.66552805,
                       0.29815065, -0.48814912,
                       0.98504800, -0.35112957,
                       0.08927648, 0.47024878,
                       -0.62386657, 0.94764720,
                       -0.74442825, -0.23434026,
                       -0.13390210, 0.45161996,
                       -0.63176002, 0.34495007,
                       -0.08153555, -0.60787577,
                       -0.78736697, 0.18455650,
                       -0.23270864, 0.81350725,
                       0.44190418, 0.70571203,
                       -0.99009068, -0.43944003,
                       0.12999981, -0.24686463,
                       -0.13294845, -0.46326282,
                       0.25183945, 0.73636560,
                       0.66065101, -0.24226394,
                       0.95050116, 0.53955745,
                       0.33319627, -0.63942371,
                       0.93338725, 0.93506578,
                       0.49853848, 0.69256893,
                       -0.78722527, -0.25588840,
                       0.19234306, -0.76413201,
                       -0.38937192, 0.18993888,
                       0.13837552, -0.32406686,
                       -0.37606129, -0.55655557,
                       0.47440264, 0.16142359,
                       0.74381488, -0.51693721,
                       -0.26292902, 0.50335388,
                       0.39451210, -0.32307855,
                       0.47496186, 0.97121030,
                       0.09565012, 0.55033429,
                       -0.22121855, 0.09410698,
                       -0.02171860, 0.34850781,
                       -0.47501441, -0.51450012,
                       -0.54138620, 0.77966493,
                       -0.59395820, -0.42366644,
                       -0.40667007, -0.93595810,
                       -0.09924392, -0.87418202,
                       -0.63053915, 0.79862532,
                       -0.71092052, 0.44421475,
                       0.52664536, 0.57745589,
                       -0.86668516, -0.07233832,
                       0.92800425, 0.45239107,
                       0.61697350, 0.95162538,
                       -0.29792230, -0.28251585,
                       -0.12711358, -0.88387297,
                       0.30408984, -0.96433158,
                       0.22368107, 0.38996913,
                       -0.73669354, 0.32534153,
                       0.31207560, 0.31817213,
                       -0.85407778, 0.01696401,
                       0.92975714, 0.88408842,
                       -0.24531799, -0.21036499,
                       -0.31677254, -0.29594029,
                       -0.92842638, -0.80086264,
                       -0.40822822, -0.73335345,
                       -0.87508877, -0.68355487,
                       -0.97106640, -0.44077274,
                       0.55934218, 0.40599736,
                       -0.05526943, 0.08184023,
                       -0.15107005, 0.35274258,
                       0.88324161, -0.44707080,
                       0.93030365, -0.61634946,
                       -0.84827180, 0.59330855,
                       -0.73820708, 0.64657819,
                       -0.32809741, 0.86253229,
                       -0.09543385, 0.91213283,
                       -0.79525187, 0.68243417,
                       0.86616842, -0.91109629,
                       -0.41697566, 0.18462927,
                       -0.68272046, -0.97079852,
                       -0.65806497, 0.34353325,
                       0.10150882, 0.76224514,
                       -0.10209313, 0.40978919,
                       -0.68794461, 0.74868135,
                       0.69258428, -0.84396666,
                       0.91549069, 0.25279834,
                       0.55336941, -0.28408789,
                       0.80246940, 0.09665311,
                       -0.80927838, 0.29645083,
                       0.09428759, 0.00744434,
                       0.53879997, 0.33549558,
                       0.57374388, -0.59394624,
                       0.53406067, -0.44746855,
                       -0.41995846, -0.45637953,
                       0.76318248, -0.65035813,
                       -0.33157128, 0.07220709,
                       0.42148860, -0.76430499,
                       -0.65806448, -0.96242973,
                       -0.10168601, 0.27820186,
                       -0.96959209, -0.87765923,
                       -0.09617281, -0.50725226,
                       0.10867356, 0.94038227,
                       0.26453875, 0.53677424,
                       -0.76469680, -0.02278831,
                       -0.70175965, -0.46132395,
                       -0.35159191, 0.34222173,
                       0.02950522, -0.21931675,
                       -0.14950086, 0.94696276,
                       -0.99278686, 0.76055413,
                       -0.52959877, 0.68372171,
                       -0.78986732, -0.06298400,
                       -0.09474183, -0.81315943,
                       0.16901136, -0.98858384,
                       -0.99174869, 0.37981153,
                       -0.30444199, -0.56300152,
                       0.04526403, 0.29677333,
                       -0.13961592, 0.66470805,
                       0.69942477, -0.22980295,
                       -0.86770646, -0.91195545,
                       0.51633334, -0.11115358,
                       0.64638003, 0.10257386,
                       -0.64585919, 0.12104401,
                       0.94178807, -0.36066833,
                       -0.74138219, 0.27822534,
                       -0.52947810, -0.49921662,
                       -0.28888372, -0.44868480,
                       0.53691203, -0.24408882,
                       0.45180009, 0.04386755,
                       -0.48943161, 0.65597685,
                       0.94773302, 0.22063002,
                       0.62240035, -0.64461619,
                       0.92810620, -0.10433948,
                       0.73247784, -0.35725588,
                       0.69254252, 0.70987443,
                       -0.98940283, 0.73647833,
                       -0.21126627, -0.84349147,
                       -0.81804447, 0.27710481,
                       0.39137915, -0.83086032,
                       0.74113858, 0.21967831,
                       0.03933765, 0.65903282,
                       -0.04271920, 0.13390294,
                       0.67760906, 0.12255466,
                       0.09234113, -0.76251931,
                       0.63135622, -0.24662090,
                       -0.20022994, 0.98273088,
                       -0.79013951, 0.35784784,
                       0.59102918, -0.53784985,
                       -0.66394674, -0.87265422,
                       -0.95505325, 0.13217158,
                       0.08601391, 0.63434926,
                       -0.51227633, -0.57493946,
                       -0.66190283, 0.49919818,
                       -0.15085186, 0.56289130,
                       -0.17179874, -0.30487653,
                       -0.37106068, -0.79906463,
                       0.67355948, -0.01349474,
                       -0.16942851, 0.60600342,
                       -0.76472102, 0.99339374,
                       -0.17605994, 0.31803540,
                       -0.35992977, 0.43305306,
                       0.38495650, -0.90282320,
                       0.11605135, 0.17816849,
                       -0.13352313, -0.80450090,
                       -0.30032483, -0.48807254,
                       -0.85663108, 0.06892112,
                       0.26450779, 0.65811173,
                       -0.90494407, -0.83266396,
                       -0.18650507, 0.84171862,
                       0.68964909, -0.95045630,
                       -0.07615523, 0.82381815,
                       -0.04180724, -0.46045907,
                       0.93707935, -0.44925773,
                       0.62292546, 0.25267573,
                       -0.83985629, 0.01548432,
                       -0.21750865, -0.54315624,
                       -0.10015825, 0.43732865,
                       -0.57071350, -0.11918885,
                       -0.33270783, 0.69163872,
                       -0.87594501, 0.12526246,
                       -0.97743333, 0.65766718,
                       -0.36010544, -0.78103986,
                       -0.79161744, 0.64834932,
                       -0.58115798, 0.81416413,
                       0.45619884, -0.14495540,
                       0.98890466, 0.64183525,
                       0.87534348, -0.81601738,
                       -0.63782956, -0.57177505,
                       -0.96704197, -0.13033612,
                       -0.70474472, 0.92024285,
                       -0.92101557, 0.76855808,
                       -0.54445749, 0.61556548,
                       0.50665571, 0.69272085,
                       -0.64949119, 0.87280565,
                       0.19786821, 0.60808039,
                       0.23786410, 0.09094600,
                       -0.51502281, -0.14939635,
                       -0.16822615, -0.20767338,
                       -0.51249081, 0.69346494,
                       0.18064605, -0.91736217,
                       0.82079061, -0.16263434,
                       0.42314399, 0.05623706,
                       -0.11443568, 0.03137943,
                       -0.53589894, -0.28774694,
                       -0.07713659, 0.36681219,
                       -0.29041673, -0.67984696,
                       -0.43992029, -0.78602204,
                       0.91150833, 0.93068323,
                       0.23100286, 0.94044436,
                       0.52239106, -0.41562780,
                       0.90862777, 0.82639145,
                       -0.76162515, -0.26276473,
                       -0.27401542, -0.38561742,
                       0.88600230, -0.25606906,
                       -0.82734476, -0.72571926,
                       0.69282454, -0.71916284,
                       -0.76938050, -0.14121942,
                       0.60617265, 0.15758422,
                       0.63302972, 0.02271575,
                       -0.92391514, 0.26779175,
                       0.47820253, -0.80941632,
                       0.48881262, -0.15050731,
                       0.21024406, -0.98606476,
                       0.06067665, -0.40174289,
                       -0.78138360, 0.91670402,
                       0.79071570, 0.95394586,
                       0.17944247, -0.40255314,
                       -0.14710929, 0.01911418,
                       0.91043816, 0.10791267,
                       0.48223441, 0.00872916,
                       -0.00119024, 0.76064831,
                       -0.09852610, -0.30311980,
                       -0.51809028, -0.00844018,
                       -0.48220464, -0.72662803,
                       -0.11601539, 0.65685132,
                       -0.08555595, 0.81189062,
                       -0.62726383, -0.96379053,
                       -0.82978641, 0.70646223,
                       0.98927307, -0.24889825,
                       -0.61089432, 0.15353882};


    double test1_label[] = {
            -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1,
            1, -1, -1, 1, 1, -1, 1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, -1, 1, 1, 1,
            1, -1, -1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, -1, -1, 1, 1,
            1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, -1, 1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, 1,
            -1, 1, -1, 1, 1, 1, 1, 1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, 1, -1, -1, 1,
            1, 1, -1, 1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1, 1, 1, 1, -1, -1, 1,
            -1, -1, 1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, 1,
            1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, 1, -1, 1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1,
            -1, -1, 1, 1, 1, 1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, 1, 1,
            -1, -1, -1, -1, -1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, -1, 1,
            -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, -1, -1, 1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, -1, 1, -1, 1, -1, -1, -1,
            1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, 1, -1, 1, 1, -1, 1, -1, 1, 1,
            -1, 1, 1, 1, 1, 1, -1, 1, -1, -1, -1, -1, 1, -1, -1, -1, 1, -1, -1, -1, -1, -1, 1, 1, 1, 1, -1, 1, 1, 1, 1, 1, 1, 1, -1, -1,
            1, -1, -1, 1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1
    };

    double test2[] = {0, 0,
                      0, 1,
                      1, 0,
                      1, 1};
    double test2_label[] = {0, 1, 1, 0};

    int epochs = 4000;
    double alpha = 0.01;
    int inputSize = 2;
    int outputSize = 1;

    MultiLayerNetwork network(inputSize);
    network.addLayer("hidden-layer1", 16, new Relu());
    network.addLayer("hidden-layer2", 8, new Sigmoid());
    network.addLayer("hidden-layer3", 4, new Sigmoid());
    network.addLayer("hidden-layer3", 2, new Sigmoid());
    network.addLayer("output-layer", outputSize, new Hyperbolic());

    network.initialize();

    network.dump();
    using namespace std::chrono;
    int64_t timestamp = duration_cast<milliseconds>(system_clock::now().time_since_epoch()).count();
    network.train(test1, test1_label, 500, epochs, alpha);
    int64_t total = duration_cast<milliseconds>(system_clock::now().time_since_epoch()).count() - timestamp;

    cout << total << " ms" << endl;

    int correct = 0;
    for (int i = 0; i < 1000; i += 2) {
        double response = test1_label[i / 2];
        vector<double> predictions = network.predict(new double[2]{test1[i], test1[i + 1]});

        if (predictions[0] <=0 && response <0) {
            correct++;
        }
        if (predictions[0] > 0 && response > 0) {
            correct++;
        }

        cout << "response=" << response << " | prediction=" << vectorToString(predictions) << endl;
    }

    cout << "correct = " << correct << endl;

    network.dump();
}
